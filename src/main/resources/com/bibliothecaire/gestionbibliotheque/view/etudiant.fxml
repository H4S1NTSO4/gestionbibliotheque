<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import org.kordamp.ikonli.javafx.*?>
<StackPane xmlns:fx="http://javafx.com/fxml/1" xmlns="http://javafx.com/javafx/21"
           fx:controller="com.bibliothecaire.gestionbibliotheque.controller.EtudiantController"
           stylesheets="@../style/etudiant.css">

  <VBox fx:id="mainContent" styleClass="content-area">

    <HBox styleClass="content-header">
      <VBox>
        <Label text="Membres - Étudiants" styleClass="content-title"/>
        <Label text="Gérez les étudiants inscrits dans la bibliothèque." styleClass="content-subtitle"/>
      </VBox>
      <HBox alignment="CENTER_RIGHT" spacing="10" HBox.hgrow="ALWAYS">
        <Button text="IMPORTER" styleClass="btn-secondary" onAction="#handleImport"/>
        <Button text="AJOUTER" styleClass="btn-primary" onAction="#handleAjouter"/>
      </HBox>
    </HBox>

    <HBox styleClass="filter-bar" alignment="CENTER_LEFT">

      <HBox spacing="10" alignment="CENTER_LEFT">
        <Label text="Rechercher" styleClass="filter-label"/>
        <TextField fx:id="txtRecherche" promptText="Matricule, nom ou email" prefWidth="300" styleClass="text-field"/>
      </HBox>

      <Region HBox.hgrow="ALWAYS"/>

      <HBox spacing="5" alignment="CENTER_RIGHT">
        <Button styleClass="btn-icon" onAction="#handleRefresh">
          <graphic>
            <FontIcon iconLiteral="fas-sync-alt" styleClass="icon-refresh"/>
          </graphic>
          <tooltip>
            <Tooltip text="Actualiser la liste"/>
          </tooltip>
        </Button>
        <Button styleClass="btn-icon" onAction="#handleExport">
          <graphic>
            <FontIcon iconLiteral="fas-file-export" styleClass="icon-export"/>
          </graphic>
          <tooltip>
            <Tooltip text="Exporter la liste (CSV/Excel)"/>
          </tooltip>
        </Button>
        <Button styleClass="btn-icon" onAction="#handlePrint">
          <graphic>
            <FontIcon iconLiteral="fas-print" styleClass="icon-print"/>
          </graphic>
          <tooltip>
            <Tooltip text="Imprimer la liste"/>
          </tooltip>
        </Button>
      </HBox>
    </HBox>

    <VBox styleClass="table-area" VBox.vgrow="ALWAYS">
      <TableView fx:id="etudiantsTable" styleClass="table-view" VBox.vgrow="ALWAYS">
        <columns>
          <TableColumn fx:id="colMatricule" text="Matricule" prefWidth="100"/>
          <TableColumn fx:id="colNomPrenoms" text="Nom et Prénoms" prefWidth="250"/>
          <TableColumn fx:id="colEmail" text="Email" prefWidth="280"/>
          <TableColumn fx:id="colTelephone" text="Téléphone" prefWidth="150"/>

          <TableColumn fx:id="colMention" text="Mention" prefWidth="150"/>
          <TableColumn fx:id="colParcours" text="Parcours" prefWidth="150"/>
          <TableColumn fx:id="colGroupe" text="Groupe" prefWidth="100"/>

          <TableColumn fx:id="colActions" text="Actions" prefWidth="80" style="-fx-alignment: CENTER;"/>
        </columns>
        <columnResizePolicy>
          <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
        </columnResizePolicy>
      </TableView>

      <HBox styleClass="pagination-bar" alignment="CENTER_LEFT">
        <Label fx:id="lblTotalEtudiants" text="Total: 0 étudiant(s)" styleClass="pagination-total"/>
        <Region HBox.hgrow="ALWAYS"/>

        <HBox spacing="15" alignment="CENTER_RIGHT">
          <Label fx:id="lblPaginationInfo" text="1-10 sur 20" styleClass="pagination-label"/>

          <Button fx:id="btnPrevious" onAction="#handlePreviousPage" styleClass="btn-icon">
            <graphic>
              <FontIcon iconLiteral="fas-chevron-left" iconSize="12" styleClass="icon-refresh"/>
            </graphic>
          </Button>

          <Button fx:id="btnNext" onAction="#handleNextPage" styleClass="btn-icon">
            <graphic>
              <FontIcon iconLiteral="fas-chevron-right" iconSize="12" styleClass="icon-refresh"/>
            </graphic>
          </Button>
        </HBox>
      </HBox>
    </VBox>
  </VBox>

  <VBox fx:id="loadingOverlay" styleClass="loading-overlay" visible="false" managed="false" spacing="10">
    <ProgressIndicator styleClass="loading-spinner" maxWidth="50" maxHeight="50"/>
    <Label text="Chargement des données..." style="-fx-text-fill: #374151; -fx-font-size: 16px;"/>
  </VBox>

</StackPane>